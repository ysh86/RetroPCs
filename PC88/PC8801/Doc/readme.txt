FPGA版8801互換機readme:
本RTLは1chip MSX又はDE0,DE0-CV(TERASIC社)のFPGAを書き換えて
PC-8801mkII SR相当の機能を持たせる物です。

本RTLに関しては、フリーソフトウェアです。
・Z80 CPUのIP : T80はDaniel Wallnerさんに著作権があります。
一部は えすび さんと私、プーによって修正されています。
えすび さんのブログ:Ｐ６つくろうブログ
http://sbeach.seesaa.net/

その他のRTLに関しては私、プーにあります。
このRTLに含まれるファイルに関しては一切無保証です。2次的被害を含む一切の責任は
負いません。

動作異常等に関しては、ブログ
http://fpga8801.seesaa.net/
内のメッセージやコメントにて連絡をお願いいたします。

使用方法:
本RTLはAltera社の開発環境 QuartusII web editionにて主に開発されており、
本配布もQuartusIIのarchive機能にてパッケージ化されております。
本RTLをProject→Restore archived projectにて展開を行い
(このファイルが開けている時点で完了していると思いますが)
コンパイルを行いますが、ライセンス等の関係でコンパイルに必要なファイルが
いくつか不足しております。
・Font/fonth.hex
テキスト画面用のフォントです。
8×16dotのフォントデータをインテルヘキサに変換した物を
上記ファイル名で保存してください。
8x8dotではありませんので注意してください。
私は漢字ROMの8×16dot部分を抜き出した物を使用しています。

上記の準備が出来たらStart Compilationにてコンパイルを行ってください。
コンパイル後、その他のfirmwareを各ボードに書き込むための操作が必要に
なります。
操作方法は同梱の「ROM_address.xls」を参照してください。
1chip版は出来上がったpofファイルをASモードで書き込みすれば完了です。
DE0版はJTAGモードで.sofファイルを書き込めば電源を切るまでの間はテスト可能です。
Configuration ROMに書く場合はRUN/PROGスイッチをPROGに切り替えてから
電源を投入し、ASモードで.pofファイルを書き込めば電源を切っても
再投入時にconfiguration ROMから起動されます。

尚、スイッチに関しては
・電源スイッチ…DE0、1chip版共に本体の電源スイッチです。
・リセットスイッチ…1chip:本体リセットスイッチ DE0:プッシュスイッチの一番左
機能切替は
・DE0:10連のスライドスイッチで行います。
右から
・MODE0
・MODE1
・ターミナル:0/BASIC:1
・FDDモータパワーセーブ 無効:0/有効:1
・80桁:0/40桁:1
・25行:0/20行:1
・ディスクブート:0/しない:1
・FDD0=300rpm:0/360rpm:1
・FDD1=300rpm:0/360rpm:1
・4MHz:0/8MHz:1
です。
MODE切り替えは、
           SW1 SW0
N-basic     0   0
N88-V1(S)   0   1
N88-V1(H)   1   0
N88-V2      1   1
となります。
1chip版はDIPスイッチには接続されていません。(底面に有って操作が面倒な為)
RTL:S88TOP.vhdのarchitecture部beginの直後(1280行目辺り)を中心に
固定値を代入しています。

尚、本RTLではSDカードは一切使用しません。

補助記憶としてはFDDを使用します。
2014年現在一般的に入手可能なドライブとしては3.5"の1.44MB用(AT互換機用)が
唯一ではないかと思いますのでこのドライブを接続できるようになっております。
PC-8801では2ドライブが一般的ですので2ドライブ接続できるようになっており、
接続には本体(1chipMSX,DE0)からの信号をAT互換機用FDDケーブル
(2ドライブ用のコネクタが3個付いており、一部が捻られた34芯ケーブル)
に変換して接続することになります。
接続に関しては、同梱の
1chip版:pin-assign_1chip.xls
DE0版,DE0-CV版:pin-assign_DE0.xls
を参照ください。
メディアに関しては2DDメディアを使用します。2HDメディアでも使用できますが
メディア検出ホール(ライトプロテクトノッチの反対側)をセロテープ等で塞いで
使用してください。
2Dとして使用する場合は偶数シリンダー目のみ書き込みを行い、奇数シリンダー目は
無視します。(DITT等で書いた場合と同じ)
5"ドライブも恐らく使用可能だと思います。AT互換機用5"ドライブは
360rpmですのでスライドスイッチ等で360rpmに変更してください。
但し、5"は2HDと2DDでメディアの磁性特性が異なる為2DD/2Dメディアは
正常に取り扱いが出来ない可能性があります。その場合は
2HDメディアを2DD/2Dフォーマットで使えるか、DENnピンを
制御したらうまくいくのではないかと予想しておりますが
AT互換機用2HDドライブは手持ちがありませんので試験をしておりません。
2D用ドライブを接続した場合はヘッドシークパルスを2倍のパルス数
出力してしまいますので一部修正が必要になります。

DE0版ではRS-232C(i8251相当)が有効になっています。BASIC及びターミナルモードで
使用可能です。ボーレートは9600bps(rtlで指定)固定です。
CMTに設定してもボーレートは変化しません。いずれの場合も基板右上のRS-232Cスルーホールに
出力されます。CMT用のモデムは接続されていません。
1chip版は8251自体が実装されていません。RS-232C及びCMTを使用するソフトは正常に
動作しないと思います。
注意:基板シルクに書かれている信号名は間違えています。RTSは本来出力信号ですが
レシーバが、CTSは本来入力信号ですがドライバが接続されています。従い、この２信号は
rtlでは逆に使用しています。(それぞれ8251の同名信号に接続)
基板からの5本の結線以外にDTRとDSRをショートさせ、RXD⇔TXD、RTS⇔CTS結線した
クロスケーブルにて通信確認を行っています。